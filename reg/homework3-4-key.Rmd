---
title: 'Homework #4'
author: 
output: html_document
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# this chunk sets the chunk options for the whole document
require(knitr)
opts_chunk$set(warning=FALSE, message=FALSE)
```

1a)

```{r}
playbill <- read.csv("playbill.csv")
m1 <- lm(CurrentWeek ~ LastWeek, data = playbill)
SE_beta1 <- summary(m1)$coef[2, 2]
t_crit <- qt(.975, nrow(playbill) - 2)
beta_1 <- m1$coef[2]
c(beta_1 - t_crit * SE_beta1, beta_1 + t_crit * SE_beta1)
```

The 95% confidence interval for the slope is (`r confint(m1, "LastWeek")[1]`,
`r confint(m1, "LastWeek")[2]`).  We are 95% confident that the true value of 
$\beta$ lies within this interval so 1 is indeed a plausible value.  We can check
out answer using the built-in `confint()` function.

```{r}
confint(m1, "LastWeek")
```


1b)

```{r}
beta_0_null <- 10000
SE_beta0 <- summary(m1)$coef[1, 2]
t_stat <- (m1$coef[1] - beta_0_null)/SE_beta0
pval <- pt(t_stat, df = nrow(playbill) - 2) * 2
```

A t-test of $H_0: \beta_0 = 10000$ yields a p-value of `r pval`, so we fail to
reject the null hypothesis at the $\alpha = .05$ level.  Our data are consistent
with a model that has an intercept of 10000.

1c)

```{r}
x_star <- 400000
pi1 <- predict(m1, data.frame("LastWeek" = x_star), interval = "prediction")
```

The 95% prediction interval ranges from `r pi[2]` to `r pi[3]`, so $450,000
is not a feasible value for a production with $400,000 in gross box office the 
previous week.

1d)

```{r}
confint(m1)
```

The promoter's claim that next week's earnings can be predicted by this week's
earnings is equivalent to claiming that $\beta_0 = 0$ and $\beta_1 = 1$.  Both
of these values lie within our confidence intervals for the slope and intercept,
so we have no reason to think that rule is inappropriate.


2a)

```{r}
indicators <- read.table("indicators.txt", header=TRUE, quote="\"")
m2 <- lm(PriceChange ~ LoanPaymentsOverdue, data = indicators)
ci <- confint(m2, "LoanPaymentsOverdue")
```

The 95% confidence interval for the slope ranges from `r ci[1]` to `r ci[2]`, which
provides interval in which the true slope may plausibly lie.  Because of this,
we have evidence that there is a significant negative relationship between the
percentage of overdue payments and the price change.

2b)

```{r}
ci <- predict(m2, data.frame("LoanPaymentsOverdue" = 4), interval = "confidence")
```

Our model predicts that metro areas with a 4% overdue payment rate will have an 
average price change of `r ci[1]`, and we are 95% confident that the true average
price change lies within (`r ci[2]`, `r ci[3]`).  Observing a 0% price change
is outside of this range and is therefore unfeasible.

3a)

```{r}
invoices <- read.delim("invoices.txt")
m3 <- lm(Time ~ Invoices, data = invoices)
beta_0_hat <- m3$coef[1]
t_stat <- qt(.975, nrow(invoices) - 2)
SE <- summary(m3)$coef[1,2]
ci <- c(beta_0_hat - t_stat * SE, beta_0_hat + t_stat * SE) 
ci
```

3b)

```{r}
beta_1_null <- .01
beta_1_hat <- m3$coef[2]
SE <- summary(m3)$coef[2, 2]
t_stat <- (beta_1_hat - beta_1_null) / SE
pval <- (1 - pt(t_stat, nrow(invoices) - 2)) * 2
```

Testing the hypothesis that $\beta_1 = 0.01$ against a two-sided alternative
yields a p-value of `r pval`, which is greater than the traditional cutoff of
0.05, therefore we fail to reject the null hypothesis.  It is entirely feasible that
this company is operating according to the best practice benchmarch.

3c)

```{r}
pi  <- predict(m3, data.frame("Invoices" = 130), interval = "prediction")
```

Our model provides a point estimate of `r pi[1]` hours to process 130, with a 
prediction interval of (`r pi[2]`, `r pi[3]`).

7.  The confusion of the reviewer lies in the distinction between a confidence
interval for the regression line and the prediction intervals for the observed
$Y^*$s.  The scatter plots in the manscript show the former, which is only trying
to capture the uncertaintly in the regression line, that is, the conditional *mean*.
The data is suppossed to be scattered about the regression line but mostly within
the prediction intervals.  The reviewer is erroneously expecting the CI to behave
like a PI.


